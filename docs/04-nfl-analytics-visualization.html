<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>An Introduction to NFL Analytics with R - 5&nbsp; Data Visualization with NFL Analytics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05-nfl-analytics-advanced-methods.html" rel="next">
<link href="./03-nfl-analytics-functions.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-0ZLEFZL898"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-0ZLEFZL898', { 'anonymize_ip': true});
</script><script src="site_libs/quarto-diagram/mermaid.min.js"></script><script src="site_libs/quarto-diagram/mermaid-init.js"></script><link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">
<span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Visualization with NFL Analytics</span>
</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">An Introduction to NFL Analytics with R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/bcongelio/nfl-analytics-with-r-book" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Share" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
<li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
            <i class="bi bi-bi-twitter pe-1"></i>
          Twitter
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
            <i class="bi bi-bi-facebook pe-1"></i>
          Facebook
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
            <i class="bi bi-bi-linkedin pe-1"></i>
          LinkedIn
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-nfl-analytics-and-r.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">An Introduction to NFL Analytics and the R Programming Language</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-nfl-analytics-tidyverse.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Wrangling NFL Data in the <code>tidyverse</code></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-nfl-analytics-functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">NFL Analytics with the <code>nflverse</code> Family of Packages</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-nfl-analytics-visualization.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Visualization with NFL Analytics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-nfl-analytics-advanced-methods.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Advanced Methods: Modeling and Big Data Bowl</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Appendices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a1-nfl-analytics-dictionary.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">NFL Analytics Reference Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a2-nfl-further-reading.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Further Reading Suggestions</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#data-viz-must-understand-the-audience" id="toc-data-viz-must-understand-the-audience" class="nav-link active" data-scroll-target="#data-viz-must-understand-the-audience"><span class="toc-section-number">5.1</span>  Data Viz Must Understand the Audience</a></li>
  <li><a href="#setting-up-for-data-viz" id="toc-setting-up-for-data-viz" class="nav-link" data-scroll-target="#setting-up-for-data-viz"><span class="toc-section-number">5.2</span>  Setting Up for Data Viz</a></li>
  <li><a href="#selecting-the-correct-type-of-plot" id="toc-selecting-the-correct-type-of-plot" class="nav-link" data-scroll-target="#selecting-the-correct-type-of-plot"><span class="toc-section-number">5.3</span>  Selecting The Correct Type of Plot</a></li>
  <li><a href="#the-basics-of-using-ggplot2" id="toc-the-basics-of-using-ggplot2" class="nav-link" data-scroll-target="#the-basics-of-using-ggplot2"><span class="toc-section-number">5.4</span>  The Basics of Using <code>ggplot2</code></a></li>
  <li>
<a href="#building-a-data-viz-a-step-by-step-process" id="toc-building-a-data-viz-a-step-by-step-process" class="nav-link" data-scroll-target="#building-a-data-viz-a-step-by-step-process"><span class="toc-section-number">5.5</span>  Building A Data Viz: A Step-by-Step Process</a>
  <ul class="collapse">
<li><a href="#adding-team-colors-to-each-point" id="toc-adding-team-colors-to-each-point" class="nav-link" data-scroll-target="#adding-team-colors-to-each-point"><span class="toc-section-number">5.5.1</span>  Adding Team Colors to Each Point</a></li>
  <li><a href="#increasing-the-size-of-each-point" id="toc-increasing-the-size-of-each-point" class="nav-link" data-scroll-target="#increasing-the-size-of-each-point"><span class="toc-section-number">5.5.2</span>  Increasing The Size of Each Point</a></li>
  <li><a href="#adding-player-names-to-each-point" id="toc-adding-player-names-to-each-point" class="nav-link" data-scroll-target="#adding-player-names-to-each-point"><span class="toc-section-number">5.5.3</span>  Adding Player Names to Each Point</a></li>
  <li><a href="#editing-axis-ticks-and-values" id="toc-editing-axis-ticks-and-values" class="nav-link" data-scroll-target="#editing-axis-ticks-and-values"><span class="toc-section-number">5.5.4</span>  Editing Axis Ticks and Values</a></li>
  <li><a href="#changing-axis-titles-and-adding-title-subtitle-and-caption" id="toc-changing-axis-titles-and-adding-title-subtitle-and-caption" class="nav-link" data-scroll-target="#changing-axis-titles-and-adding-title-subtitle-and-caption"><span class="toc-section-number">5.5.5</span>  Changing Axis Titles and Adding Title, Subtitle, and Caption</a></li>
  <li><a href="#adding-mean-lines-to-both-x-axis-and-y-axis" id="toc-adding-mean-lines-to-both-x-axis-and-y-axis" class="nav-link" data-scroll-target="#adding-mean-lines-to-both-x-axis-and-y-axis"><span class="toc-section-number">5.5.6</span>  Adding Mean Lines to Both x-axis and y-axis</a></li>
  <li><a href="#making-changes-to-theme-elements" id="toc-making-changes-to-theme-elements" class="nav-link" data-scroll-target="#making-changes-to-theme-elements"><span class="toc-section-number">5.5.7</span>  Making Changes to Theme Elements</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title d-none d-lg-block">
<span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Visualization with NFL Analytics</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>Effective data visualization is an important part of any data analysis project as it helps in highlighting key insights into the data, identifying trends, patterns, and anomalies, as while as allowing you to communicate results to the outside world.</p>
<p>Jim Stikeleather, writing for the <em>Harvard Business Review</em>, outlined three key elements that make a successful data visualization (albeit, leaving <em>us</em> to decide the definition of what a “successful” data visualization is). Despite that philosophical gap, the three elements provided by Stikeleather are succinct enough to allow us to build a framework in this chapter for how to successfully craft an NFL analytics data visualization. In his piece, Stikeleather outlines the following three characteristics of a successful data visualization: it understands the audience, it sets up a clear framework, and it tells a story <span class="citation" data-cites="stikeleather2013">(<a href="references.html#ref-stikeleather2013" role="doc-biblioref">Stikeleather 2013</a>)</span>.</p>
<p>To illustrate the importance of these three elements, let’s take a look at example visualizations using NFL data to further contextualize each one.</p>
<section id="data-viz-must-understand-the-audience" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="data-viz-must-understand-the-audience">
<span class="header-section-number">5.1</span> Data Viz Must Understand the Audience</h2>
<p>As explained by Stikeleather, the core purpose of a data visualization is to take “great quantities of information” and then convey that information in such a way that it is “easily assimilated by the consumers of the information.” In other words, the process of data visualization should allow for a great quantity of data to be distilled into an easily consumable (and understandable!) format.</p>
<p>Speaking specifically to NFL analytics, when doing visualizations we must be conscious about whether or not the intended audience will understand the terminology and concepts we use in the plot. For example, most all NFL fans understand the “non-advanced” statistics in the sport. But, when plots start using metrics such as EPA or completion percentage over expected, for example, the audience looking at the plot may very well have little understanding of what is being conveyed.</p>
<p>Because of this, any data viz I create never fails to include “directables” within the plot. These “directables” may be arrows that indicate which trend on the plot are “good” or they can be text within a scatterplot that explains what each quadrant means. Or, for example, I sometimes include a textual explanation of the “equation” used to develop a metric as seen below:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="images/finished-aggressiveness.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>The above plot explores which QBs, from the 2020 season, were most aggressive on 3rd down with between 5 to 10 yards to go. Since “aggressiveness” is not a typical, day-to-day metric discussed by NFL fans, I included a “directable” within the subtitle of the plot that explained that the plot, first, was examining just 3rd down pass attempts within a specific yard range. And, second, I made the decision to include how “aggressiveness” was calculated by including the simple equation within the subtitle as well. Doing so allows even the most casual of NFL fans to easily understand what the plot is showing - in this case, that Joe Burrow’s 3rd down pass attempts with between 5 to 10 yards to go made it to the line of gain, or more, on 68% of his attempts. On the other hand, Drew Lock and Drew Brees were the least aggressive QBs in the line based on the same metric.</p>
<p>As another example, below is what I deemed my “Uncle Rico Metric” (because who does not like a good Napoleon Dynamite reference?):</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="images/unclerico.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="setting-up-for-data-viz" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="setting-up-for-data-viz">
<span class="header-section-number">5.2</span> Setting Up for Data Viz</h2>
<p>While most of your journey through NFL analytics in this book required you to use the <code>tidyverse</code> and a handful of other packages, the process of creating compelling and meaningful data visualizations will require you to utilize multitudes of other packages. Of course, the most important is <code>ggplot2</code> which is already installed via the <code>tidyverse</code>. However, in order to recreate the visualizations included in this chapter, it is required that you install other R packages. To install the necessary packages, you can run the following code in RStudio:</p>
<p>Need to install: <code>ggrepel</code></p>
</section><section id="selecting-the-correct-type-of-plot" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="selecting-the-correct-type-of-plot">
<span class="header-section-number">5.3</span> Selecting The Correct Type of Plot</h2>
<p>Content coming soon and testing flowchart.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<p>
</p>
<pre class="mermaid mermaid-js" data-tooltip-selector="#mermaid-tooltip-1">flowchart

A[Data Type]
A --&gt; B(Continuous)
A --&gt; C(Discrete)
C --&gt; D(Two Discrete Variables)
D --&gt; E(Relationships)
D --&gt; F(Counts)
E --&gt; G{geom_point}
E --&gt; H{geom_jitter}
C --&gt; I(One Discrete, One Continuous)
I --&gt; J(Distribution)
I --&gt; K(Summary)
J --&gt; L{geom_boxplot}
J --&gt; M{geom_violin}
K --&gt; N{geom_bar}
K --&gt; O{geom_col}
B --&gt; P(Two Continuous Variables)
P --&gt; Q{geom_point}
P --&gt; R{geom_line}
B --&gt; S(One Continuous, One Discrete)
S --&gt; T(Distribution)
S --&gt; U(Summary)
T --&gt; V{geom_boxplot}
T --&gt; W{geom_violin}
U --&gt; X{geom_bar}
B --&gt; Y(One Continuous)
Y --&gt; Z(Histogram)
Y --&gt; AA(Density)
Z --&gt; BB{geom_histogram}
Z --&gt; CC{geom_density}

</pre>
<div id="mermaid-tooltip-1" class="mermaidTooltip">

</div>

</div>
</div>
</div>
</section><section id="the-basics-of-using-ggplot2" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="the-basics-of-using-ggplot2">
<span class="header-section-number">5.4</span> The Basics of Using <code>ggplot2</code>
</h2>
<p>The basics of any <code>ggplot</code> visualization involves three basic calls to information in a dataset as well as stipulation which type of geom you would like to use:</p>
<ol type="1">
<li>the dataset to be used in the visualization</li>
<li>an aesthetic calls for the x-axis</li>
<li>an aesthetic call for the y-axis</li>
<li>your desired geom type</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="st">'dataset_name'</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="st">'x_axsis'</span>, y <span class="op">=</span> <span class="st">'y_axis'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_type</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To showcase this, let’s use data from Sports Info Solutions that pertains quarterback statistic when using play action versus when not using play action. To start, collect the data using the <code>vroom</code> function.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">play_action_data</span> <span class="op">&lt;-</span> <span class="fu">vroom</span><span class="fu">::</span><span class="fu"><a href="https://vroom.r-lib.org/reference/vroom.html">vroom</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/bcongelio/nfl-analytics-with-r-book/origin/example_data/csv/play_action_data.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To provide an easy-to-understand example of building a visualization with <code>ggplot</code>, let’s use each QB’s total yardage when using play action and when not. In this case, our two variable names are <code>yds</code> and <code>pa_yds</code> with the <code>yds</code> variable being place on the x-axis and the <code>pa_yds</code> variable being placed on the y-axis.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is important to remember which axis is which as you begin to learn using <code>ggplot</code>:</p>
<p>The x-axis is the horizontal axis that runs left-to-right.</p>
<p>The y-axis is the vertical axis that runs top-to-bottom.</p>
</div>
</div>
<div class="cell" data-layout-align="center" data-fig.dpi="300">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">play_action_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">yds</span>, y <span class="op">=</span> <span class="va">pa_yds</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-nfl-analytics-visualization_files/figure-html/example-pa-action-plot-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="building-a-data-viz-a-step-by-step-process" class="level2" data-number="5.5"><h2 data-number="5.5" class="anchored" data-anchor-id="building-a-data-viz-a-step-by-step-process">
<span class="header-section-number">5.5</span> Building A Data Viz: A Step-by-Step Process</h2>
<p>The outputted scatter plot is an excellent starting point for a more finely detailed visualization. While we are able to see the relationship between non-play action passing yards and those attempts that included play action, we are unable to discern which specific point is which quarterback - among other issues. To provide more detail and to “prettify” the plot, let’s discuss doing the following:</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Our data visualization “to do list”:</p>
<ol type="1">
<li>Adding team colors to each point.</li>
<li>Increasing the size of each point.</li>
<li>Adding player names to each point.</li>
<li>Increasing the number of ticks on each axis.</li>
<li>Provide the numeric values in correct format (that is, including a <code>,</code> to correctly show thousands).</li>
<li>Rename the title of each axis.</li>
<li>Provide a title, subtitle, and caption for the plot.</li>
<li>Add mean lines to both the x-axis and y-axis</li>
<li>Change <code>theme</code> elements to make data viz more appealing.</li>
</ol>
</div>
</div>
<section id="adding-team-colors-to-each-point" class="level3" data-number="5.5.1"><h3 data-number="5.5.1" class="anchored" data-anchor-id="adding-team-colors-to-each-point">
<span class="header-section-number">5.5.1</span> Adding Team Colors to Each Point</h3>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Much like anything in the R language, there are multiple ways to go about add team colors (and logos, player headshots, etc.) to visualizations.</p>
<p>First, we can merge team color information into our <code>play_action_data</code> and then manually set the colors in our <code>geom_point</code> call.</p>
<p>Second, we can conduct the same merge but then use the <code>nflplotRr</code> package (which is part of the <code>nflverse</code>) to bring the colors in.</p>
<p>Both examples will be included in the below example. However, please note that I typically <em>do not</em> use the <code>nflplotR</code> package in scatter plots as, in certain circumstances, adding the colors manually provides the necessary control that <code>nflplotR</code> sometimes cannot provide.</p>
<p>That said, the power of <code>nflplotR</code> is extremely evident when working with team logos and/or player headshots (which will be covered later in this chapter).</p>
</div>
</div>
<p>To start, we will load team information using the <code>load_teams</code> function within <code>nflreadr</code>. In this case, we are requesting that the package provide only the 32 current NFL teams with by including the <code>current = TRUE</code> argument. Conversely, setting the argument to <code>current = FALSE</code> will result in historical NFL teams being included in the data (the Oakland Raiders and St.&nbsp;Louis Rams, for example, will be included in the data). We will also use the <code>select</code> verb from <code>dplyr</code> to gather just the variables we know we will need (<code>team_abbr</code>, <code>team_nick</code>, <code>team_color</code>, and <code>team_color2</code>.</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>We are only including the <code>team_abbr</code> variable in this example because we are going to create the plot both with and without the use of <code>nflplotR</code>. As of the writing of this book, the newest development version of the package is 1.1.0.9004 and does not yet (if ever) provide support to use team nicknames. Because of this, we must include <code>team_abbr</code> in our merge since it is the team name version that is standardized for use in <code>nflplotr</code>.</p>
</div>
</div>
<p>After collecting the team information needed, we can conducted a <code>left_join</code> to match the information by <code>team</code> in <code>play_action_data</code> and <code>team_nick</code> in the team information from <code>load_teams()</code> and then confirm the merge was successful by viewing the columns names in <code>play_action_data</code> with <code><a href="https://rdrr.io/r/base/colnames.html">colnames()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">teams</span> <span class="op">&lt;-</span> <span class="fu">nflreadr</span><span class="fu">::</span><span class="fu"><a href="https://nflreadr.nflverse.com/reference/load_teams.html">load_teams</a></span><span class="op">(</span>current <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">team_abbr</span>, <span class="va">team_nick</span>, <span class="va">team_color</span>, <span class="va">team_color2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">play_action_data</span> <span class="op">&lt;-</span> <span class="va">play_action_data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">teams</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"team"</span> <span class="op">=</span> <span class="st">"team_nick"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">play_action_data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With the team color information now built into our <code>play_action_data</code>, we can incorporate the team color specific to each point by including the <code>color</code> argument within our <code>geom_point</code>.</p>
<div class="cell" data-layout-align="center" data-fig.dpi="300">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">play_action_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">yds</span>, y <span class="op">=</span> <span class="va">pa_yds</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>color <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">team_color</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-nfl-analytics-visualization_files/figure-html/adding-team-color-no-nflplotr-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>You may notice that we used the the <code>$</code> special operator to extract the <code>team_color</code> information within our <code>play_action_data</code> dataframe. This is an extremely important distinction, as using the <code>aes()</code> argument from <code>ggplot</code> and not using the <code>$</code> operator will result in a custom scale color being applied to each team, without the correct team colors associating with the correct team.</p>
<p>To see this for yourself, you can run the example following code. Remember, this is an incorrect approach and serves to only highlight why the <code>$</code> special operator was used in the above code.</p>
<div class="cell" data-layout-align="center" data-fig.dpi="300">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">play_action_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">yds</span>, y <span class="op">=</span> <span class="va">pa_yds</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">team_color</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-nfl-analytics-visualization_files/figure-html/incorrect-use-of-aes-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>As mentioned, the same result can be achieved using the <code>nflplotR</code> package. The following code will do so:</p>
<div class="cell" data-layout-align="center" data-fig.dpi="300">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">play_action_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">yds</span>, y <span class="op">=</span> <span class="va">pa_yds</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">team_abbr</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">nflplotR</span><span class="fu">::</span><span class="fu"><a href="https://nflplotr.nflverse.com/reference/scale_nfl.html">scale_color_nfl</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"primary"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-nfl-analytics-visualization_files/figure-html/adding-color-with-nflplotr-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>In the above example, you will notice that we are including the team color information in an <code>aes()</code> call within the <code>geom_point()</code> function. This is because we ultimately control the specific of the custom scale through the use of <code>scale_color_nfl</code> in the <code>nflplotR</code> package, which also allows us to select whether we want to display the primary or secondary team color.</p>
<p>Given the two examples above, a couple items regarding the use of <code>nflplotR</code> should become apparent.</p>
<ol type="1">
<li>If your data already includes team names in <code>team_abbr</code> format (that is: BAL, CIN, DET, DAL, etc.), then using <code>nflplotR</code> is likely a more efficient option as you do not need to merge in team color information. In other words, our <code>play_action_data</code> information could contain just the variables for <code>player</code>, <code>team_abbr</code>, <code>yds</code>, and <code>pa_yds</code> and <code>nflplotR</code> would still work as the package, “behind the scenes”, will automatically correlate the <code>team_abbr</code> with the correct color for each team.</li>
<li>However, if your data does not include teams in <code>team_abbr</code> format and you must merge in information manually, it is likely more efficient to use the <code>$</code> special operator to bring the team colors in without using the <code>aes()</code> call within <code>geom_point()</code>.</li>
</ol>
<p>Finally, because we have both <code>team_color</code> and <code>team_color2</code> - the primary and secondary colors for each team - in the data, we can get fancy and create points that are filled with the primary team color and outlined by the secondary team color. Doing so simply requires changing the type of our <code>geom_point</code>. In the below example, we are specifying that we want a specific type of <code>geom_point</code> by using <code>shape = 21</code> and then providing the <code>fill</code> color and the outline color with <code>color</code>. In each case, we are again using the <code>$</code> special operator to select the primary and secondary color associated with each team.</p>
<div class="cell" data-layout-align="center" data-fig.dpi="300">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">play_action_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">yds</span>, y <span class="op">=</span> <span class="va">pa_yds</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>,</span>
<span>             fill <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">team_color</span>,</span>
<span>             color <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">team_color2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-nfl-analytics-visualization_files/figure-html/adding-shape-21-to-plot-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>With team colors correctly associated with each point, we can turn back to our “to do list” to see what part of the job is next.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Our data visualization “to do list”:</p>
<ol type="1">
<li><p><del>Adding team colors to each point.</del></p></li>
<li><p>Increasing the size of each point.</p></li>
<li><p>Adding player names to each point.</p></li>
<li><p>Increasing the number of ticks on each axis.</p></li>
<li><p>Provide the numeric values in correct format (that is, including a , to correctly show thousands).</p></li>
<li><p>Rename the title of each axis.</p></li>
<li><p>Provide a title, subtitle, and caption for the plot.</p></li>
<li><p>Add mean lines to both the x-axis and y-axis.</p></li>
<li><p>Change <code>theme</code> elements to make data viz more appealing.</p></li>
</ol>
</div>
</div>
</section><section id="increasing-the-size-of-each-point" class="level3" data-number="5.5.2"><h3 data-number="5.5.2" class="anchored" data-anchor-id="increasing-the-size-of-each-point">
<span class="header-section-number">5.5.2</span> Increasing The Size of Each Point</h3>
<p>Determining when and how to resize the individual points in a scatterplot is a multifaceted decision. To that end, there is no hard and fast rule for doing so as it depends on both the specific goals and context of the visualization. There are, however, some general guidelines to keep in mind:</p>
<ol type="1">
<li>Data density: if you have a lot of data points within your plot, making the points smaller may help to reduce issues of overlapping/overplotting. Not only is this more aesthetically pleasing, but it can also help in making it easier to see patterns.</li>
<li>Important of individual points: if certain points within the scatterplot are important, we may want to increase the size of those specific points to make them standout.</li>
<li>Visual aesthetics: the size of the points can be adjusted simply for visual appeal.</li>
<li>Contextual factors: can the size of the points be used to highlight even more uniqueness in the data? For example, given the right data structure, we can size individual dots to show the spread in total attempts across the quarterbacks.</li>
</ol>
<p>Given the above guidelines, the resizing of the points in our <code>play_action_data</code> dataframe is going to be a strictly aesthetic decision. We cannot, as mentioned above, alter the size of each specific points based on each quarterback’s number of attempts as the data provides attempts for <em>both</em> play action and non-play action passes. Moreover, we <em>could</em>&nbsp;create a new column that add both attempt numbers to get a QB’s cumulative total but that does not have a distinct correlation to the data on either axis.</p>
<div class="callout-caution callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Danger
</div>
</div>
<div class="callout-body-container callout-body">
<p>For the sake of educational purposes, we can alter the size of each specific point to correlate to the total number of play action attempts for each quarterback (and then divide this by 25 in order to decrease the size of the points to fit them all onto the plot).</p>
<p>Again: it is important to point out that this not a good approach to data visualization, as the size of the dots correlates to just one of the variables being explored in the plot.</p>
<div class="cell" data-layout-align="center" data-fig.dpi="300">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">play_action_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">yds</span>, y <span class="op">=</span> <span class="va">pa_yds</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>,</span>
<span>             fill <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">team_color</span>,</span>
<span>             color <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">team_color2</span>,</span>
<span>             size <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">pa_att</span> <span class="op">/</span> <span class="fl">25</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-nfl-analytics-visualization_files/figure-html/incorrect-use-of-sizing-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>In order to maintain correct visualization standards, we can resize the points for nothing more than aesthetic purposes (that is: making them bigger so they are easier to see). To do so, we still add the <code>size</code> argument to our <code>geom_point</code> but simply provide a numeric value to apply uniformly across all the points. To process of selecting the numeric value is a case of trial and error - inputting and running, changing and running, and changing and running again until you find the size that provides easier to see points without adding overlap into the visualization.</p>
<div class="cell" data-layout-align="center" data-fig.dpi="300">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">play_action_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">yds</span>, y <span class="op">=</span> <span class="va">pa_yds</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>,</span>
<span>             fill <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">team_color</span>,</span>
<span>             color <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">team_color2</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-nfl-analytics-visualization_files/figure-html/adding-correct-size-to-points-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>With the size of each point adequately adjusted, we can move on to the next part of our data visualization “to do list.”</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Our data visualization “to do list”:</p>
<ol type="1">
<li><p><del>Adding team colors to each point.</del></p></li>
<li><p><del>Increasing the size of each point.</del></p></li>
<li><p>Adding player names to each point.</p></li>
<li><p>Increasing the number of ticks on each axis.</p></li>
<li><p>Provide the numeric values in correct format (that is, including a , to correctly show thousands).</p></li>
<li><p>Rename the title of each axis.</p></li>
<li><p>Provide a title, subtitle, and caption for the plot.</p></li>
<li><p>Add mean lines to both the x-axix and y-axis.</p></li>
<li><p>Change <code>theme</code> elements to make data viz more appealing.</p></li>
</ol>
</div>
</div>
</section><section id="adding-player-names-to-each-point" class="level3" data-number="5.5.3"><h3 data-number="5.5.3" class="anchored" data-anchor-id="adding-player-names-to-each-point">
<span class="header-section-number">5.5.3</span> Adding Player Names to Each Point</h3>
<p>While the our current plot includes team-specific colors for the points, we are still not able to discern - for the most part - which player belongs to which point. To rectify this, we will turn to using the <code>ggrepel</code> package, which is designed to improve the readability of text labels on plots by automatically repelling overlapping labels, if any. To that end, <code>ggrepel</code> operates out of two main functions: <code>geom_text_repel</code> and <code>geom_label_repel</code>. Both provide the same end result, with the core different being <code>geom_label_repel</code> adding a customized label under each player’s name.</p>
<p>We can do a bare minimum addition of the player names by adding one additional line of code using <code>geom_text_repel</code> and wrapping it in an <code>aes()</code> call and specifying which variable in the <code>play_action_data</code> is the <code>label</code> we would like to display.</p>
<div class="cell" data-layout-align="center" data-fig.dpi="300">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">play_action_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">yds</span>, y <span class="op">=</span> <span class="va">pa_yds</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>,</span>
<span>             fill <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">team_color</span>,</span>
<span>             color <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">team_color2</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">player</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-nfl-analytics-visualization_files/figure-html/basic-addition-of-player-name-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>While it is a good first attempt at adding the names, many of them are awkwardly close to the respective point. Luckily, the <code>ggrepel</code> package provides plenty of built-in customization options:</p>
<table class="table">
<thead><tr class="header">
<th style="text-align: center;">
<code>ggrepel</code> Option<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>
</th>
<th style="text-align: center;">Description of Option</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">seed</td>
<td style="text-align: center;">a random numeric seed number for the purposes of recreating the same layout</td>
</tr>
<tr class="even">
<td style="text-align: center;">force</td>
<td style="text-align: center;">force of repulsion between overlapping text labels</td>
</tr>
<tr class="odd">
<td style="text-align: center;">force_pull</td>
<td style="text-align: center;">force of attraction between each text label and its data point</td>
</tr>
<tr class="even">
<td style="text-align: center;">direction</td>
<td style="text-align: center;">move the text labels in either “x” or “y” directions</td>
</tr>
<tr class="odd">
<td style="text-align: center;">nudge_x</td>
<td style="text-align: center;">adjust the starting x-axis starting position of the label</td>
</tr>
<tr class="even">
<td style="text-align: center;">nudge_y</td>
<td style="text-align: center;">adjust the starting y-axis starting position of the label</td>
</tr>
<tr class="odd">
<td style="text-align: center;">box.padding</td>
<td style="text-align: center;">padding around the text label</td>
</tr>
<tr class="even">
<td style="text-align: center;">point.padding</td>
<td style="text-align: center;">padding around the labeled data point</td>
</tr>
<tr class="odd">
<td style="text-align: center;">arrow</td>
<td style="text-align: center;">renders the line segment as an arrow</td>
</tr>
</tbody>
</table>
<p>Of the above options, the our current issue with name and point spacing can be resolved by including a numeric value to the <code>box.padding</code>. Moreover, we can control the look and style of the text (such as size, font family, font face, etc.) in much the same way. To make these changes, we can set the <code>box.padding</code> to 0.45, set the size of the text to 3 using <code>size</code> as well as switch the font to ‘Roboto Condensed’ using <code>family</code>, and - finally - make it bold using <code>fontface</code>.</p>
<div class="cell" data-layout-align="center" data-fig.dpi="300">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">play_action_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">yds</span>, y <span class="op">=</span> <span class="va">pa_yds</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>,</span>
<span>             fill <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">team_color</span>,</span>
<span>             color <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">team_color2</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">player</span><span class="op">)</span>,</span>
<span>                  box.padding <span class="op">=</span> <span class="fl">0.45</span>,</span>
<span>                  size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                  family <span class="op">=</span> <span class="st">"Roboto Condensed"</span>,</span>
<span>                  fontface <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-nfl-analytics-visualization_files/figure-html/add-ggrepel-options-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>The plot, as is, is understandable in that we are able to associate each point with a specific quarterback to examine how a quarterback’s total passing yardage is split between play action and non-play action passes. While the graph could hypothetically “standalone” as is - minus a need for a title - we can still do work on it to make it more presentable. Let’s return to our data visualization “to do list.”</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Our data visualization “to do list”:</p>
<ol type="1">
<li><p><del>Adding team colors to each point.</del></p></li>
<li><p><del>Increasing the size of each point.</del></p></li>
<li><p><del>Adding player names to each point.</del></p></li>
<li><p>Increasing the number of ticks on each axis.</p></li>
<li><p>Provide the numeric values in correct format (that is, including a , to correctly show thousands).</p></li>
<li><p>Rename the title of each axis.</p></li>
<li><p>Provide a title, subtitle, and caption for the plot.</p></li>
<li><p>Add mean lines to both x-axis and y-axis.</p></li>
<li><p>Change <code>theme</code> elements to make data viz more appealing.</p></li>
</ol>
</div>
</div>
</section><section id="editing-axis-ticks-and-values" class="level3" data-number="5.5.4"><h3 data-number="5.5.4" class="anchored" data-anchor-id="editing-axis-ticks-and-values">
<span class="header-section-number">5.5.4</span> Editing Axis Ticks and Values</h3>
<p>Because steps 4 and 5 from the above “to do list” can be accomplished with the same package, we will lump both together and complete them at once.</p>
<p>Let’s first examine the idea of increasing the number of ticks on each axis. The “axis ticks” refer to the specific spots on each axis wherein a numeric datapoint resides. With our current visualization, we currently have “1000, 2000, 3000” on the x-axis and “400, 800, 1200, 1600” on the y-axis.</p>
<p>We may want to increase the number of axis ticks in this visualization as it can provide a more detailed view of the data being presented. Typically, increasing the number of tickets will show more granularity in the data and make it easier to interpret the values represented by each point. In this specific case, we can look at the cluster of points represented by Andy Dalton, Mac Jones, and Matt Ryan. Given the current structure of the axis ticks, we can guess that Matt Ryan has roughly 2,500 yards on non-play action passing attempts. Given we know Matt Ryan’s amount, we can make guesses that Andy Dalton may be around 2,300 and Mac Jones somewhere between the two.</p>
<p>By increasing the number of values on each axis, we have the ability to see more specific results. Conversely, we must be careful to not add too many so that the data becomes overwhelming to interpret. Much like the size of <code>geom_point</code> was a case of trial and error, so is selecting an appropriate amount of ticks.</p>
<p>However, before implementing these changes, we need to segue into a discussion on continuous and discrete data.</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>When implementing changes to either the x- or y-axis in <code>ggplot</code>, you will be working with either continuous or discrete data, and using the <code>scale_x_continuous</code> or <code>scale_x_discrete</code> functions (or replacing <code>x</code> with <code>y</code> when working with the opposite axis). In either case, both functions allow you to customize the axis of a plot but are used for different types of data.</p>
<p><code>scale_x_continuous</code> is used for continuous (or numeric) data, where the axis is represented by a continuous range of numeric values. The values within a continuous axis can take on any number within the given range.</p>
<p><code>scale_x_discrete</code> is used for discrete data (or often character-based data). You will see this function used when working with variables such as player names, teams, college names, etc. In any case, discrete data is limited to a specific set of categories.</p>
<p>Please know that <code>ggplot</code> will throw an error if you try to apply a continuous scale to discrete data, or the opposite, that reads: <code>Error: Discrete value supplied to continuous scale</code>.</p>
</div>
</div>
<p>In the case of our current plot, we now know we will be using the <code>scales_x_continuous</code> and <code>scale_y_continuous</code> functions as both contain continuous (numeric) data. To make the changes, we can turn to the <code>scales</code> package and its <code>pretty_breaks</code> function to change the number of “breaks” (or ticks) on each axis. By placing <code>n = 6</code> within the <code>pretty_breaks</code> argument, we are requesting a total of six axis ticks on both the x- and y-axis.</p>
<div class="cell" data-layout-align="center" data-fig.dpi="300">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">play_action_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">yds</span>, y <span class="op">=</span> <span class="va">pa_yds</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>,</span>
<span>             fill <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">team_color</span>,</span>
<span>             color <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">team_color2</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">player</span><span class="op">)</span>,</span>
<span>                  box.padding <span class="op">=</span> <span class="fl">0.45</span>,</span>
<span>                  size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                  family <span class="op">=</span> <span class="st">"Roboto Condensed"</span>,</span>
<span>                  fontface <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-nfl-analytics-visualization_files/figure-html/add-breaks-with-scales-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Despite our request to build the plot with six ticks on each axis, you will see the generated visualization includes seven on the x-axis and eight on the y-axis. <em>This does not mean your code with <code>pretty_breaks</code></em> <em>did not work</em>. Instead, the <code>pretty_breaks</code> function is designed to internally determine the best axis tick optimization based on your requested number. To that end, the function - “under the hood” - determined that seven and eight ticks, respectively, was the most optimized way to display the data given our desire to have at least six on each.</p>
<p>With the number of axis ticks corrected, we can turn our attention to getting the labels of the axis ticks into correct numeric format. Within the same <code>scale_x_continuous</code> or <code>scale_y_continuous</code> arguments, we will use the <code>labels</code> function, combined with another tool from the <code>scales</code> package to make the adjustments.</p>
<div class="cell" data-layout-align="center" data-fig.dpi="300">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">play_action_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">yds</span>, y <span class="op">=</span> <span class="va">pa_yds</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>,</span>
<span>             fill <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">team_color</span>,</span>
<span>             color <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">team_color2</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">player</span><span class="op">)</span>,</span>
<span>                  box.padding <span class="op">=</span> <span class="fl">0.45</span>,</span>
<span>                  size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                  family <span class="op">=</span> <span class="st">"Roboto Condensed"</span>,</span>
<span>                  fontface <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html">label_comma</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html">label_comma</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-nfl-analytics-visualization_files/figure-html/add-commas-to-values-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>By adding a <code>labels</code> option to both <code>scale_x_continuous</code> and <code>scale_y_continuous</code>, we can use the <code>label_comma()</code> option from within the <code>scales</code> package to easily add a comma into numbers that are in the thousands.</p>
<p>With much of the heavy lifting for our visualization now complete, we can move on to the final steps in our “to do list.”</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Our data visualization “to do list”:</strong></p>
<ol type="1">
<li><p><del>Adding team colors to each point.</del></p></li>
<li><p><del>Increasing the size of each point.</del></p></li>
<li><p><del>Adding player names to each point.</del></p></li>
<li><p><del>Increasing the number of ticks on each axis.</del></p></li>
<li><p><del>Provide the numeric values in correct format (that is, including a , to correctly show thousands).</del></p></li>
<li><p>Rename the title of each axis.</p></li>
<li><p>Provide a title, subtitle, and caption for the plot.</p></li>
<li><p>Add mean lines to both x-axis and y-axis.</p></li>
<li><p>Change <code>theme</code> elements to make data viz more appealing.</p></li>
</ol>
</div>
</div>
</section><section id="changing-axis-titles-and-adding-title-subtitle-and-caption" class="level3" data-number="5.5.5"><h3 data-number="5.5.5" class="anchored" data-anchor-id="changing-axis-titles-and-adding-title-subtitle-and-caption">
<span class="header-section-number">5.5.5</span> Changing Axis Titles and Adding Title, Subtitle, and Caption</h3>
<p>Much like our last section, we can work on changing the title of each axis and adding a title, subtitle, and caption for the plot within one section, as all this is added and/or changed by using <code>labs()</code>.</p>
<div class="cell" data-layout-align="center" data-fig.dpi="300">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">play_action_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">yds</span>, y <span class="op">=</span> <span class="va">pa_yds</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>,</span>
<span>             fill <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">team_color</span>,</span>
<span>             color <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">team_color2</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">player</span><span class="op">)</span>,</span>
<span>                  box.padding <span class="op">=</span> <span class="fl">0.45</span>,</span>
<span>                  size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                  family <span class="op">=</span> <span class="st">"Roboto Condensed"</span>,</span>
<span>                  fontface <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html">label_comma</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html">label_comma</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Non-Play Action Yards"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Play Action Yards"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Cumulative Passing Yards"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Non-Play Action vs. Play Action"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"An Introduction to NFL Analytics with R - Brad J. Congelio"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-nfl-analytics-visualization_files/figure-html/using-labs-for-title-caption-sub-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Within the new <code>labs()</code>, we are placing a total of five items: <code>x</code> (allowing us to name the x-axis outside the confines of what it is called in the beginning <code>aes()</code> call, <code>y</code> (allowing us to name the y-axis), <code>title</code> (allowing us to add a title to the top of the plot), <code>subtitle</code> (allowing us to add a subtitle below the title and provide more contextual information), and <code>caption</code> (allowing us to provide information about where the graph come from and who designed it). We will explore ways to change the font, size, color, and more of these items when we move on to the last item of our “to do list.”</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Our data visualization “to do list”:</strong></p>
<ol type="1">
<li><p><del>Adding team colors to each point.</del></p></li>
<li><p><del>Increasing the size of each point.</del></p></li>
<li><p><del>Adding player names to each point.</del></p></li>
<li><p><del>Increasing the number of ticks on each axis.</del></p></li>
<li><p><del>Provide the numeric values in correct format (that is, including a , to correctly show thousands).</del></p></li>
<li><p><del>Rename the title of each axis.</del></p></li>
<li><p><del>Provide a title, subtitle, and caption for the plot.</del></p></li>
<li><p>Add mean lines to both x-axis and y-axis.</p></li>
<li><p>Change theme elements to make data viz more appealing.</p></li>
</ol>
</div>
</div>
</section><section id="adding-mean-lines-to-both-x-axis-and-y-axis" class="level3" data-number="5.5.6"><h3 data-number="5.5.6" class="anchored" data-anchor-id="adding-mean-lines-to-both-x-axis-and-y-axis">
<span class="header-section-number">5.5.6</span> Adding Mean Lines to Both x-axis and y-axis</h3>
<p>Adding mean (or average) lines to both the x-axis and y-axis allows us to visualize where each quarterback falls within one of four sections (according to the amount of passing yards in both situations). Adding the lines is done by add two additional geoms to the existing plot (in this case <code>geom_hline</code> and <code>geom_vline</code>).</p>
<div class="cell" data-layout-align="center" data-fig.dpi="300">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">play_action_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">yds</span>, y <span class="op">=</span> <span class="va">pa_yds</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">geom_point</span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>,</span>
<span>             fill <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">team_color</span>,</span>
<span>             color <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">team_color2</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">player</span><span class="op">)</span>,</span>
<span>                  box.padding <span class="op">=</span> <span class="fl">0.45</span>,</span>
<span>                  size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                  family <span class="op">=</span> <span class="st">"Roboto Condensed"</span>,</span>
<span>                  fontface <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html">label_comma</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html">label_comma</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Non-Play Action Yards"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Play Action Yards"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Cumulative Passing Yards"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Non-Play Action vs. Play Action"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"An Introduction to NFL Analytics with R - Brad J. Congelio"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">play_action_data</span><span class="op">$</span><span class="va">pa_yds</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">.8</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">play_action_data</span><span class="op">$</span><span class="va">yds</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">.8</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-nfl-analytics-visualization_files/figure-html/add-avg-lines-incorrectly-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>In the above output, we used <code>geom_hline</code> and <code>geom_vline</code> to draw a dashed line at the average for both <code>pa_yds</code> at the <code>yintercept</code> and <code>yds</code> at the <code>xintercept</code>. Because of this, we can see that - for example - Marcus Mariota is above average for play action yards, but below average for non-play action yards. Additionally, Matthew Stafford, Baker Mayfield, Kyler Murray, and many others are all below average in both metrics while Jared Goff, Justin Herbert, Patrick Mahomes, and others are well above average in both.</p>
<p>However, adding the <code>geom_hline</code> and <code>geom_vline</code> at the very end of the <code>ggplot</code> code creates an issues (and one I’ve intentionally created for the purposes of education). As you look at the plot, you will see that the dashed line runs <strong>on top</strong> of the names and dots in the plot. This is because <code>ggplot</code> follows a very specific ordering of layering.</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>In <code>ggplot</code>, it is important to remember that items in a plot are layered in the order in which they are added to the plot. This process of layering is important because it ultimately determines which items end up on top of others, which can have significant implications on the visual appearance of the plot.</p>
<p>As we’ve seen so far in the process, each layer of a plot is added by including a <code>geom_</code>. The first layer added will <em>always</em> be at the very bottom of the plot, with each additional layer building on top of the previous layers.</p>
</div>
</div>
<p>Because of the important layering issue highlighted above, it is visually necessary for us to move the <code>geom_hline</code> and <code>geom_vline</code> to the beginning of the <code>ggplot</code> code so both are layered underneath everything else in the plot (<code>geom_point</code> and <code>geom_text_repel</code> in this case). As well, we can apply the <code>alpha</code> option to each to slightly decrease each line’s transparency.</p>
<div class="cell" data-layout-align="center" data-fig.dpi="300">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">play_action_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">yds</span>, y <span class="op">=</span> <span class="va">pa_yds</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">play_action_data</span><span class="op">$</span><span class="va">pa_yds</span><span class="op">)</span>, </span>
<span>             linewidth <span class="op">=</span> <span class="fl">.8</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"black"</span>, </span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>             alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">play_action_data</span><span class="op">$</span><span class="va">yds</span><span class="op">)</span>, </span>
<span>             linewidth <span class="op">=</span> <span class="fl">.8</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"black"</span>, </span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>             alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">geom_point</span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>,</span>
<span>             fill <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">team_color</span>,</span>
<span>             color <span class="op">=</span> <span class="va">play_action_data</span><span class="op">$</span><span class="va">team_color2</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">player</span><span class="op">)</span>,</span>
<span>                  box.padding <span class="op">=</span> <span class="fl">0.45</span>,</span>
<span>                  size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                  family <span class="op">=</span> <span class="st">"Roboto Condensed"</span>,</span>
<span>                  fontface <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html">label_comma</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html">label_comma</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Non-Play Action Yards"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Play Action Yards"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Cumulative Passing Yards"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Non-Play Action vs. Play Action"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"An Introduction to NFL Analytics with R - Brad J. Congelio"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-nfl-analytics-visualization_files/figure-html/correctly-adding-avg-lines-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>By moving the average lines to the top of our <code>ggplot</code> code, both are now layered under the other two <code>geom_</code> and are not visually impacting the final plot. We can now move onto the final item on our data visualization “to do list.”</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Our data visualization “to do list”:</strong></p>
<ol type="1">
<li><p><del>Adding team colors to each point.</del></p></li>
<li><p><del>Increasing the size of each point.</del></p></li>
<li><p><del>Adding player names to each point.</del></p></li>
<li><p><del>Increasing the number of ticks on each axis.</del></p></li>
<li><p><del>Provide the numeric values in correct format (that is, including a , to correctly show thousands).</del></p></li>
<li><p><del>Rename the title of each axis.</del></p></li>
<li><p><del>Provide a title, subtitle, and caption for the plot.</del></p></li>
<li><p><del>Add mean lines to both x-axis and y-axis.</del></p></li>
<li><p>Change theme elements to make data viz more appealing.</p></li>
</ol>
</div>
</div>
</section><section id="making-changes-to-theme-elements" class="level3" data-number="5.5.7"><h3 data-number="5.5.7" class="anchored" data-anchor-id="making-changes-to-theme-elements">
<span class="header-section-number">5.5.7</span> Making Changes to Theme Elements</h3>
<p>Content to be uploaded soon.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-stikeleather2013" class="csl-entry" role="doc-biblioentry">
Stikeleather, Jim. 2013. <span>“The Three Elements of Successful Data Visualizations.”</span> <a href="https://hbr.org/2013/04/the-three-elements-of-successf">https://hbr.org/2013/04/the-three-elements-of-successf</a>.
</div>
</div>
</section></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>As listed on the <code>ggrepel</code> website: <a href="https://ggrepel.slowkow.com/articles/examples.html" class="uri">https://ggrepel.slowkow.com/articles/examples.html</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./03-nfl-analytics-functions.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">NFL Analytics with the <code>nflverse</code> Family of Packages</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05-nfl-analytics-advanced-methods.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Advanced Methods: Modeling and Big Data Bowl</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">NFL Analytics with R was written by Bradley J. Congelio.</div>   
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a></div>
  </div>
</footer>


</body></html>